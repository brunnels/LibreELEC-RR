From 718eae91fb9f345561e3465735cae208775fecc0 Mon Sep 17 00:00:00 2001
From: Spongman <piersh@hotmail.com>
Date: Sat, 16 Feb 2019 18:07:26 -0800
Subject: [PATCH] Update GamesDBJSONScraper.cpp

prevent `IsObject` assertion failure during `HasMember` call.
---
 es-app/src/scrapers/GamesDBJSONScraper.cpp | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)

diff --git a/es-app/src/scrapers/GamesDBJSONScraper.cpp b/es-app/src/scrapers/GamesDBJSONScraper.cpp
index a40ee2eca..8935c3833 100644
--- a/es-app/src/scrapers/GamesDBJSONScraper.cpp
+++ b/es-app/src/scrapers/GamesDBJSONScraper.cpp
@@ -322,12 +322,16 @@ void processGame(const Value& game, const Value& boxart, std::vector<ScraperSear
 		result.mdl.set("players", std::to_string(game["players"].GetInt()));
 	}
 
-	std::string id = std::to_string(getIntOrThrow(game, "id"));
-	if (boxart["data"].HasMember(id.c_str()))
+
+	if (boxart.HasMember("data") && boxart["data"].IsObject())
 	{
-		std::string image = getBoxartImage(boxart["data"][id.c_str()]);
-		result.thumbnailUrl = baseImageUrlThumb + "/" + image;
-		result.imageUrl = baseImageUrlLarge + "/" + image;
+		std::string id = std::to_string(getIntOrThrow(game, "id"));
+		if (boxart["data"].HasMember(id.c_str()))
+		{
+		    std::string image = getBoxartImage(boxart["data"][id.c_str()]);
+		    result.thumbnailUrl = baseImageUrlThumb + "/" + image;
+		    result.imageUrl = baseImageUrlLarge + "/" + image;
+		}
 	}
 
 	results.push_back(result);
